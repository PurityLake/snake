/*! snake 2020-11-29 */

const tileSize=32,halfTile=tileSize/2,tilesX=25,tilesY=20,width=tileSize*tilesX,height=tileSize*tilesY;class Snake{constructor(e,i,t,a){this.pos={x:e,y:i},this.dir={x:-1,y:0},this.tileX=t,this.tileY=a}}function getXYFromIndex(e,i){return[Math.floor(e*tileSize),Math.floor(i*tileSize)]}var config={type:Phaser.AUTO,width:width,height:height,physics:{default:"arcade",arcade:{gravity:{y:200}}},scene:{preload:preload,create:create,update:update}},upKey={},downKey={},leftKey={},rightKey={},snake={},newWidth=width,newHeight=height,widthDifference=0,heightDifference=0,game=new Phaser.Game(config);function preload(){this.load.spritesheet("snakehead","assets/snakehead.png",{frameWidth:tileSize,frameHeight:tileSize});for(var e=0;e<width;e++)newWidth%tileSize!=0&&newWidth--;for(e=0;e<height;e++)newHeight%tileSize!=0&&newHeight--;widthDifference=width-newWidth,heightDifference=height-newHeight}function create(){this.add.grid(widthDifference/2,heightDifference/2,newWidth,newHeight,tileSize,tileSize,5570560).setAltFillStyle(16711680).setOrigin(0,0);var e=Math.floor(tilesX/2),i=Math.floor(tilesY/2),[t,a]=getXYFromIndex(e,i);(snake=new Snake(t-halfTile,a-halfTile,e,i)).sprite=this.add.sprite(snake.pos.x,snake.pos.y,"snakehead"),snake.chompanim=this.anims.create({key:"chomp",frames:this.anims.generateFrameNumbers("snakehead",{start:0,end:1}),frameRate:5,repeat:-1}),snake.sprite.anims.play("chomp",!0),upKey=this.input.keyboard.addKey("up"),downKey=this.input.keyboard.addKey("down"),leftKey=this.input.keyboard.addKey("left"),rightKey=this.input.keyboard.addKey("right")}var t=0;function update(e,i){if((t+=i)>=700){upKey.isDown&&1!=snake.dir.y?(snake.sprite.angle=90,snake.dir.x=0,snake.dir.y=-1):rightKey.isDown&&-1!=snake.dir.x?(snake.sprite.angle=180,snake.dir.x=1,snake.dir.y=0):downKey.isDown&&-1!=snake.dir.y?(snake.sprite.angle=270,snake.dir.x=0,snake.dir.y=1):leftKey.isDown&&1!=snake.dir.x&&(snake.sprite.angle=0,snake.dir.x=-1,snake.dir.y=0),snake.tileX+=snake.dir.x,snake.tileY+=snake.dir.y;var[a,n]=getXYFromIndex(snake.tileX,snake.tileY);snake.pos.x=a-halfTile,snake.pos.y=n-halfTile,snake.sprite.x=snake.pos.x,snake.sprite.y=snake.pos.y,t=0}}